{% extends "layout.html" %}
{% block title %}Welcome - SmartEats{% endblock %}

{% block content %}

<style>
/* ===== SmartEats Carousel Ads & Meals ===== */

.se-carousel-card {
  max-width: 900px;
  margin: auto;
  border-radius: 1rem;
  overflow: hidden;
}

.se-carousel-image-box {
  height: 280px;            /* ðŸ”’ constant height */
  background: #f8f9fa;
  display: flex;
  align-items: center;
  justify-content: center;
}

.se-carousel-image-box img {
  width: 100%;
  height: 100%;
  object-fit: contain;        /* ðŸ”¥ consistent sizing */
}

/* Smooth fade animation */
.carousel-fade .carousel-item {
  transition: opacity 0.8s ease-in-out;
}

/* Carousel controls */
.carousel-control-prev-icon,
.carousel-control-next-icon {
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));
}
</style>

<div class="container my-4">

  {# ================= ADS CAROUSEL ================= #}
  {% if ads %}
  <div id="adsCarousel"
       class="carousel slide carousel-fade mb-5"
       data-bs-ride="carousel"
       data-bs-interval="5000"
       data-bs-pause="hover">

    <div class="carousel-inner">
      {% for ad in ads %}
      <div class="carousel-item {% if loop.first %}active{% endif %}">
        <a class="text-decoration-none"
           href="{% if ad.link_type == 'product' %}
                   {{ url_for('main.product_detail', product_id=ad.product_id) }}
                 {% elif ad.link_type == 'store' %}
                   {{ url_for('main.go_to_store', store_id=ad.store_id) }}
                 {% else %}
                   {{ ad.external_url }}
                 {% endif %}">

          <div class="card shadow-sm border-0 se-carousel-card">
            <div class="se-carousel-image-box">
              <img src="{{ ad.image }}" alt="{{ ad.title }}">
            </div>

            <div class="card-body text-center">
              <h5 class="fw-bold mb-1">{{ ad.title }}</h5>
              <span class="badge bg-success">Tap to view</span>
            </div>
          </div>

        </a>
      </div>
      {% endfor %}
    </div>

    <button class="carousel-control-prev" type="button"
            data-bs-target="#adsCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>

    <button class="carousel-control-next" type="button"
            data-bs-target="#adsCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
  {% endif %}

  {# ================= MEALS CAROUSEL ================= #}
  {% if meals %}
  <div id="mealsCarousel"
       class="carousel slide carousel-fade mb-5"
       data-bs-ride="carousel"
       data-bs-interval="5000"
       data-bs-pause="hover">

    <div class="carousel-inner">
      {% for meal in meals %}
      <div class="carousel-item {% if loop.first %}active{% endif %}">
        <a class="text-decoration-none"
           href="{{ url_for('main.viewproduct', product_id=meal.id) }}">

          <div class="card shadow-sm border-0 se-carousel-card">
            <div class="se-carousel-image-box">
              <img src="{{ meal.pictures }}" alt="{{ meal.productname }}">
            </div>

            <div class="card-body text-center">
              <h5 class="fw-bold mb-1">{{ meal.productname }}</h5>

              {% if meal.price %}
                <div class="text-muted mb-1">{{ meal.price }}</div>
              {% endif %}

              {% if meal.store_name %}
                <small class="text-secondary">{{ meal.store_name }}</small>
              {% elif meal.store and meal.store.name %}
                <small class="text-secondary">{{ meal.store.name }}</small>
              {% endif %}

              <div class="mt-2">
                <span class="badge bg-success">Order</span>
              </div>
            </div>
          </div>

        </a>
      </div>
      {% endfor %}
    </div>

    <button class="carousel-control-prev" type="button"
            data-bs-target="#mealsCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>

    <button class="carousel-control-next" type="button"
            data-bs-target="#mealsCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
  {% endif %}

</div>

{% endblock %}
