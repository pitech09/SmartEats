{% extends "layout.html" %}
{% block title %}Authentication - SmartEats{% endblock %}

{% block content %}
<div class="container-xxl">
  <div class="authentication-wrapper authentication-basic container-p-y">
    <div class="authentication-inner">

      <div class="card shadow-sm">
        <div class="card-body">

          <!-- Header -->
          <div class="text-center mb-4">
            <h4 class="fw-bold">Welcome to SmartEats </h4>
            <p class="text-muted">Login, register or manage your store</p>
          </div>

          <!-- Navigation -->
          <div class="d-flex justify-content-center gap-2 mb-4 flex-wrap">
            <button class="btn btn-outline-success btn-sm" onclick="loadAuth('login')">Login</button>
            <button class="btn btn-outline-success btn-sm" onclick="loadAuth('register')">Register</button>
            <button class="btn btn-outline-success btn-sm" onclick="loadAuth('register_store')">Register Store</button>
            <button class="btn btn-outline-secondary btn-sm" onclick="loadAuth('reset_password')">Forgot Password</button>
          </div>

          <!-- Dynamic Content -->
          <div id="auth-content">
            {% include "auth/partials/login.html" %}
          </div>

        </div>
      </div>

    </div>
  </div>
</div>

<!-- Spinner -->
<div id="auth-spinner" class="text-center my-3 d-none">
  <div class="spinner-border text-success" role="status"></div>
</div>

<script>
function loadAuth(view) {
  const spinner = document.getElementById("auth-spinner");
  const container = document.getElementById("auth-content");

  spinner.classList.remove("d-none");

  fetch(`/auth/ui/${view}`)
    .then(res => res.text())
    .then(html => {
      container.innerHTML = html;
      spinner.classList.add("d-none");
    })
    .catch(() => {
      container.innerHTML = "<p class='text-danger'>Failed to load.</p>";
      spinner.classList.add("d-none");
    });
}
</script>
{% endblock %}
